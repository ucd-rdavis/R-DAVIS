<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Coding Practice</title>

<script src="site_libs/header-attrs-2.26/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />
<link rel="stylesheet" href="site_libs_extra/academicons-1.8.0/css/academicons.css"/>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-info-circle  fa-1x"></span>
     
    About
  </a>
</li>
<li>
  <a href="syllabus.html">
    <span class="fa fa-map fa-1x"></span>
     
    Syllabus
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Set Up
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="computer_setup.html">Computer Setup</a>
    </li>
    <li>
      <a href="setting_up_git.html">Setting up Git Repository</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book  fa-1x"></span>
     
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lesson_01_intro_r_rstudio.html">Intro to Programming, R, &amp; RStudio</a>
    </li>
    <li>
      <a href="lesson_02_project_management.html">Project Management</a>
    </li>
    <li>
      <a href="lesson_03_how_r_thinks_about_data.html">How R Thinks About Data</a>
    </li>
    <li>
      <a href="lesson_04_spreadsheets_condensed.html">Spreadsheets</a>
    </li>
    <li>
      <a href="lesson_05_data_import.html">Starting With Spreadsheets in R</a>
    </li>
    <li>
      <a href="lesson_06_data_manipulation_pt1.html">Data Manipulation Pt1</a>
    </li>
    <li>
      <a href="lesson_08_data_manipulation_pt2.html">Data Manipulation Pt2</a>
    </li>
    <li>
      <a href="lesson_09_data_viz_pt1.html">Data Visualization Pt1</a>
    </li>
    <li>
      <a href="lesson_11_data_viz_pt2.html">Data Visualization Pt2</a>
    </li>
    <li>
      <a href="lesson_12_lubridate.html">Date-times with lubridate</a>
    </li>
    <li>
      <a href="lesson_13_functions.html">Writing functions</a>
    </li>
    <li>
      <a href="lesson_14_iteration.html">Iteration</a>
    </li>
    <li>
      <a href="lesson_rmarkdown.html">Literate Programming with RMarkdown</a>
    </li>
  </ul>
</li>
<li>
  <a href="lectures.html">
    <span class="fa fa-slideshare fa-1x"></span>
     
    Videos
  </a>
</li>
<li>
  <a href="assignments.html">
    <span class="fa fa-paperclip fa-1x"></span>
     
    Assignments
  </a>
</li>
<li>
  <a href="resources.html">
    <span class="fa fa-list"></span>
     
    Resources
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="contact.html">
    <span class="fa fa-hand-spock-o"></span>
     
    Contact
  </a>
</li>
<li>
  <a href="https://github.com/UCD-R-DAVIS/R-DAVIS">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Coding Practice</h1>

</div>


<p>Assignments are designed to reinforce the code/lessons covered that
week and provide you a chance to practice working with GitHub.
Assignments are to be completed in your local project (on your computer)
and pushed up to your GitHub repository for instructors to review by the
following Wednesday. That said, these due dates are largely suggestive
as a way to help you prioritize and stay caught up as a group – if you
need, or want, more time, take it. At the end of the quarter, we will
simply look over the tasks you have completed in concert with the
reflection you submit.</p>
<p><br></p>
<div id="assignments"
class="section level2 tabset tabset-fade tabset-pills">
<h2 class="tabset tabset-fade tabset-pills">Assignments</h2>
<div id="assignment-1" class="section level3">
<h3><small>Assignment 1</small></h3>
<p><br> Because this class caters to a range of experiences, we would
like you to identify how it is you plan on earning credit for this
course. Before next week, please complete <a
href="https://docs.google.com/forms/d/1aGHZra8ucJb_vKVgj75PwCDnzt9Viw5gnoVK-Qm8bZk">this
form</a> to select and describe your plans.</p>
</div>
<div id="assignment-2" class="section level3">
<h3><small>Assignment 2</small></h3>
<p>In this homework we are going to practice subsetting and manipulating
vectors.</p>
<p>First, open your r-davis-in-class-project-YourName and
<code>pull</code>. Remember, we always want to start working on a github
project by pulling, even if we are sure nothing has changed (believe me,
this small step will save you lots of headaches).</p>
<p>Second, open a new script in your r-davis-in-class-project-YourName
and save it to your <code>scripts</code> folder. Call this new script
<code>week_2_homework</code>.</p>
<p>Copy and paste the chunk of code below into your new
<code>week_2_homework</code> script and run it. This chunk of code will
create the vector you will use in your homework today. Check in your
environment to see what it looks like. What do you think each line of
code is doing?</p>
<pre class="r"><code>set.seed(15)
hw2 &lt;- runif(50, 4, 50)
hw2 &lt;- replace(hw2, c(4,12,22,27), NA)
hw2</code></pre>
<pre><code>##  [1] 31.697246 12.972021 48.457102        NA 20.885307 49.487524 41.498897
##  [8] 15.682545 35.612619 42.245735  8.814791        NA 27.418158 36.504914
## [15] 43.666428 42.722117 24.582411 48.374680 10.494605 39.728776 40.971460
## [22]        NA 20.447903  6.668049 30.024323 34.314318        NA 10.825658
## [29] 46.676823 25.913006 26.933701 15.810164 26.616794  9.403891 27.589087
## [36] 34.262403  9.591257 27.733004 17.877330 38.975078 46.102046 25.041810
## [43] 46.369401 15.919465 19.813791 23.741937 19.192818 38.630297 42.819312
## [50]  4.500130</code></pre>
<ol style="list-style-type: decimal">
<li><p>Take your <code>hw2</code> vector and removed all the NAs then
select all the numbers between 14 and 38 inclusive, call this vector
<code>prob1</code>.</p></li>
<li><p>Multiply each number in the <code>prob1</code> vector by 3 to
create a new vector called <code>times3</code>. Then add 10 to each
number in your <code>times3</code> vector to create a new vector called
<code>plus10</code>.</p></li>
<li><p>Select every other number in your <code>plus10</code> vector by
selecting the first number, not the second, the third, not the fourth,
etc. If you’ve worked through these three problems in order, you should
now have a vector that is 12 numbers long that looks
<strong>exactly</strong> like this one:</p></li>
</ol>
<pre class="r"><code>final</code></pre>
<pre><code>##  [1] 105.09174  57.04763  92.25447  83.74723 100.07297  87.73902  57.43049
##  [8]  92.76726  93.19901  85.12543  69.44137  67.57845</code></pre>
<p>Finally, save your script and push all your changes to your github
account.</p>
<details>
<summary>
<strong>DO NOT OPEN</strong> until you are ready to see the answers
</summary>
<pre class="r"><code>prob1 &lt;- hw2[!is.na(hw2)] #removing the NAs

prob1 &lt;- prob1[prob1 &gt;14 &amp; prob1 &lt; 38] #only selecting numbers between 14 and 38

times3 &lt;- prob1 * 3 #multiplying by 3

plus10 &lt;- times3 + 10 #adding 10 to the whole vector 

final &lt;- plus10[c(TRUE, FALSE)] #selecting every other number using logical subsetting</code></pre>
</details>
</div>
<div id="assignment-3" class="section level3">
<h3><small>Assignment 3</small></h3>
<p>Homework this week will be playing with the <code>surveys</code> data
we worked on in class. First things first, open your
r-davis-in-class-project and pull. Then create a new script in your
<code>scripts</code> folder called <code>week_3_homework.R</code>.</p>
<p>Load your <code>survey</code> data frame with the read.csv()
function. Create a new data frame called <code>surveys_base</code> with
only the species_id, the weight, and the plot_type columns. Have this
data frame only be the first 5,000 rows. Convert both species_id and
plot_type to factors. Remove all rows where there is an NA in the weight
column. Explore these variables and try to explain why a factor is
different from a character. Why might we want to use factors? Can you
think of any examples?</p>
<p>CHALLENGE: Create a second data frame called
<code>challenge_base</code> that only consists of individuals from your
<code>surveys_base</code> data frame with weights greater than 150g.</p>
<details>
<summary>
<strong>DO NOT OPEN</strong> until you are ready to see the answers for
the the homework
</summary>
<pre class="r"><code>#PROBLEM 1

surveys &lt;- read.csv(&quot;data/portal_data_joined.csv&quot;) #reading the data in

colnames(surveys) #a list of the column names </code></pre>
<pre><code>##  [1] &quot;record_id&quot;       &quot;month&quot;           &quot;day&quot;             &quot;year&quot;           
##  [5] &quot;plot_id&quot;         &quot;species_id&quot;      &quot;sex&quot;             &quot;hindfoot_length&quot;
##  [9] &quot;weight&quot;          &quot;genus&quot;           &quot;species&quot;         &quot;taxa&quot;           
## [13] &quot;plot_type&quot;</code></pre>
<pre class="r"><code>surveys_base &lt;- surveys[1:5000, c(6, 9, 13)] #selecting rows 1:5000 and just columns 6, 9 and 13

surveys_base &lt;- surveys_base[complete.cases(surveys_base), ] #selecting only the ROWS that have complete cases (no NAs) **Notice the comma was needed for this to work**

surveys_base$species_id &lt;- factor(surveys_base$species_id) #converting factor data to character

surveys_base$plot_type &lt;- factor(surveys_base$plot_type) #converting factor data to character

#Experimentation of factors
levels(surveys_base$species_id)</code></pre>
<pre><code>##  [1] &quot;BA&quot; &quot;DM&quot; &quot;DO&quot; &quot;DS&quot; &quot;NL&quot; &quot;OL&quot; &quot;OT&quot; &quot;OX&quot; &quot;PB&quot; &quot;PE&quot; &quot;PF&quot; &quot;PH&quot; &quot;PI&quot; &quot;PL&quot; &quot;PM&quot;
## [16] &quot;PP&quot; &quot;RF&quot; &quot;RM&quot; &quot;RO&quot; &quot;SF&quot; &quot;SH&quot; &quot;SO&quot;</code></pre>
<pre class="r"><code>typeof(surveys_base$species_id)</code></pre>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<pre class="r"><code>class(surveys_base$species_id)</code></pre>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<pre class="r"><code>#CHALLENGE
challenge_base &lt;- surveys_base[surveys_base[, 2]&gt;150,] #selecting just the weights (column 2) that are greater than 150</code></pre>
</details>
<p><br></p>
</div>
<div id="assignment-4" class="section level3">
<h3><small>Assignment 4</small></h3>
<p>By now you should be in the rhythm of pulling from your git
repository and then creating new homework script. This week the homework
will review data manipulation in the tidyverse.</p>
<ol style="list-style-type: decimal">
<li><p>Create a tibble named <code>surveys</code> from the
portal_data_joined.csv file.</p></li>
<li><p>Subset <code>surveys</code> using Tidyverse methods to keep rows
with weight between 30 and 60, and print out the first 6 rows.</p></li>
<li><p>Create a new tibble showing the maximum weight for each species +
sex combination and name it <code>biggest_critters</code>. Sort the
tibble to take a look at the biggest and smallest species + sex
combinations. HINT: it’s easier to calculate max if there are no NAs in
the dataframe…</p></li>
<li><p>Try to figure out where the NA weights are concentrated in the
data- is there a particular species, taxa, plot, or whatever, where
there are lots of NA values? There isn’t necessarily a right or wrong
answer here, but manipulate surveys a few different ways to explore
this. Maybe use <code>tally</code> and <code>arrange</code>
here.</p></li>
<li><p>Take <code>surveys</code>, remove the rows where weight is NA and
add a column that contains the average weight of each species+sex
combination to the <strong>full</strong> <code>surveys</code> dataframe.
Then get rid of all the columns except for species, sex, weight, and
your new average weight column. Save this tibble as
<code>surveys_avg_weight</code>.</p></li>
<li><p>Take <code>surveys_avg_weight</code> and add a new column called
<code>above_average</code> that contains logical values stating whether
or not a row’s weight is above average for its species+sex combination
(recall the new column we made for this tibble).</p></li>
</ol>
<details>
<summary>
<strong>DO NOT OPEN</strong> until you are ready to see the answers for
the homework
</summary>
<pre class="r"><code>library(tidyverse)
#1
surveys &lt;- read_csv(&quot;data/portal_data_joined.csv&quot;)</code></pre>
<pre><code>## Rows: 34786 Columns: 13
## ── Column specification ───────────────────────
## Delimiter: &quot;,&quot;
## chr (6): species_id, sex, genus, species, taxa, plot_type
## dbl (7): record_id, month, day, year, plot_id, hindfoot_length, weight
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>#2
surveys %&gt;% 
  filter(weight &gt; 30 &amp; weight &lt; 60)</code></pre>
<pre><code>## # A tibble: 14,730 × 13
##    record_id month   day  year plot_id species_id sex   hindfoot_length weight
##        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt;
##  1      5966     5    22  1982       2 NL         F                  32     40
##  2       226     9    13  1977       2 DM         M                  37     51
##  3       233     9    13  1977       2 DM         M                  25     44
##  4       245    10    16  1977       2 DM         M                  37     39
##  5       251    10    16  1977       2 DM         M                  36     49
##  6       257    10    16  1977       2 DM         M                  37     47
##  7       259    10    16  1977       2 DM         M                  36     41
##  8       268    10    16  1977       2 DM         F                  36     55
##  9       346    11    12  1977       2 DM         F                  37     36
## 10       350    11    12  1977       2 DM         M                  37     47
## # ℹ 14,720 more rows
## # ℹ 4 more variables: genus &lt;chr&gt;, species &lt;chr&gt;, taxa &lt;chr&gt;, plot_type &lt;chr&gt;</code></pre>
<pre class="r"><code>#3
biggest_critters &lt;- surveys %&gt;% 
  filter(!is.na(weight)) %&gt;% 
  group_by(species_id, sex) %&gt;% 
  summarise(max_weight = max(weight))</code></pre>
<pre><code>## `summarise()` has grouped output by
## &#39;species_id&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre class="r"><code>biggest_critters %&gt;% arrange(max_weight)</code></pre>
<pre><code>## # A tibble: 64 × 3
## # Groups:   species_id [25]
##    species_id sex   max_weight
##    &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt;
##  1 PF         &lt;NA&gt;           8
##  2 BA         M              9
##  3 RO         M             11
##  4 RO         F             13
##  5 RF         M             15
##  6 RM         &lt;NA&gt;          16
##  7 BA         F             18
##  8 PE         &lt;NA&gt;          18
##  9 PI         &lt;NA&gt;          18
## 10 PP         &lt;NA&gt;          18
## # ℹ 54 more rows</code></pre>
<pre class="r"><code>biggest_critters %&gt;% arrange(desc(max_weight))</code></pre>
<pre><code>## # A tibble: 64 × 3
## # Groups:   species_id [25]
##    species_id sex   max_weight
##    &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt;
##  1 NL         M            280
##  2 NL         F            274
##  3 NL         &lt;NA&gt;         243
##  4 SF         F            199
##  5 DS         F            190
##  6 DS         M            170
##  7 DS         &lt;NA&gt;         152
##  8 SH         F            140
##  9 SH         &lt;NA&gt;         130
## 10 SS         M            130
## # ℹ 54 more rows</code></pre>
<pre class="r"><code>#4
surveys %&gt;% 
  filter(is.na(weight)) %&gt;% 
  group_by(species) %&gt;% 
  tally() %&gt;% 
  arrange(desc(n))</code></pre>
<pre><code>## # A tibble: 37 × 2
##    species          n
##    &lt;chr&gt;        &lt;int&gt;
##  1 harrisi        437
##  2 merriami       334
##  3 bilineata      303
##  4 spilosoma      246
##  5 spectabilis    160
##  6 ordii          123
##  7 albigula       100
##  8 penicillatus    99
##  9 torridus        89
## 10 baileyi         81
## # ℹ 27 more rows</code></pre>
<pre class="r"><code>surveys %&gt;% 
  filter(is.na(weight)) %&gt;% 
  group_by(plot_id) %&gt;% 
  tally() %&gt;% 
  arrange(desc(n))</code></pre>
<pre><code>## # A tibble: 24 × 2
##    plot_id     n
##      &lt;dbl&gt; &lt;int&gt;
##  1      13   160
##  2      15   155
##  3      14   152
##  4      20   152
##  5      12   144
##  6      17   144
##  7      11   119
##  8       9   118
##  9       2   117
## 10      21   106
## # ℹ 14 more rows</code></pre>
<pre class="r"><code>surveys %&gt;% 
  filter(is.na(weight)) %&gt;% 
  group_by(year) %&gt;% 
  tally() %&gt;% 
  arrange(desc(n))</code></pre>
<pre><code>## # A tibble: 26 × 2
##     year     n
##    &lt;dbl&gt; &lt;int&gt;
##  1  1977   221
##  2  1998   195
##  3  1987   151
##  4  1988   130
##  5  1978   124
##  6  1982   123
##  7  1989   123
##  8  1991   108
##  9  2002   108
## 10  1992   106
## # ℹ 16 more rows</code></pre>
<pre class="r"><code>#5
surveys_avg_weight &lt;- surveys %&gt;% 
  filter(!is.na(weight)) %&gt;% 
  group_by(species_id, sex) %&gt;% 
  mutate(avg_weight = mean(weight)) %&gt;% 
  select(species_id, sex, weight, avg_weight)

surveys_avg_weight</code></pre>
<pre><code>## # A tibble: 32,283 × 4
## # Groups:   species_id, sex [64]
##    species_id sex   weight avg_weight
##    &lt;chr&gt;      &lt;chr&gt;  &lt;dbl&gt;      &lt;dbl&gt;
##  1 NL         M        218       166.
##  2 NL         M        204       166.
##  3 NL         M        200       166.
##  4 NL         M        199       166.
##  5 NL         M        197       166.
##  6 NL         M        218       166.
##  7 NL         M        166       166.
##  8 NL         M        184       166.
##  9 NL         M        206       166.
## 10 NL         F        274       154.
## # ℹ 32,273 more rows</code></pre>
<pre class="r"><code>#6
surveys_avg_weight &lt;- surveys_avg_weight %&gt;% 
  mutate(above_average = weight &gt; avg_weight)

surveys_avg_weight</code></pre>
<pre><code>## # A tibble: 32,283 × 5
## # Groups:   species_id, sex [64]
##    species_id sex   weight avg_weight above_average
##    &lt;chr&gt;      &lt;chr&gt;  &lt;dbl&gt;      &lt;dbl&gt; &lt;lgl&gt;        
##  1 NL         M        218       166. TRUE         
##  2 NL         M        204       166. TRUE         
##  3 NL         M        200       166. TRUE         
##  4 NL         M        199       166. TRUE         
##  5 NL         M        197       166. TRUE         
##  6 NL         M        218       166. TRUE         
##  7 NL         M        166       166. TRUE         
##  8 NL         M        184       166. TRUE         
##  9 NL         M        206       166. TRUE         
## 10 NL         F        274       154. TRUE         
## # ℹ 32,273 more rows</code></pre>
</details>
</div>
<div id="assignment-5" class="section level3">
<h3><small>Assignment 5</small></h3>
<p>This week’s questions will have us practicing pivots and conditional
statements.</p>
<ol style="list-style-type: decimal">
<li><p>Create a tibble named <code>surveys</code> from the
portal_data_joined.csv file. Then manipulate <code>surveys</code> to
create a new dataframe called <code>surveys_wide</code> with a column
for genus and a column named after every plot type, with each of these
columns containing the mean hindfoot length of animals in that plot type
and genus. So every row has a genus and then a mean hindfoot length
value for every plot type. The dataframe should be sorted by values in
the Control plot type column. This question will involve quite a few of
the functions you’ve used so far, and it may be useful to sketch out the
steps to get to the final result.</p></li>
<li><p>Using the original <code>surveys</code> dataframe, use the two
different functions we laid out for conditional statements, ifelse() and
case_when(), to calculate a new weight category variable called
<code>weight_cat</code>. For this variable, define the rodent weight
into three categories, where “small” is less than or equal to the 1st
quartile of weight distribution, “medium” is between (but not inclusive)
the 1st and 3rd quartile, and “large” is any weight greater than or
equal to the 3rd quartile. (Hint: the summary() function on a column
summarizes the distribution). For ifelse() and case_when(), compare what
happens to the weight values of NA, depending on how you specify your
arguments.</p></li>
</ol>
<p>BONUS: How might you soft code the values (i.e. not type them in
manually) of the 1st and 3rd quartile into your conditional statements
in question 2?</p>
<details>
<summary>
<strong>DO NOT OPEN</strong> until you are ready to see the answers for
the homework
</summary>
<pre class="r"><code># 1
library(tidyverse)
surveys &lt;- read_csv(&quot;data/portal_data_joined.csv&quot;)</code></pre>
<pre><code>## Rows: 34786 Columns: 13
## ── Column specification ───────────────────────
## Delimiter: &quot;,&quot;
## chr (6): species_id, sex, genus, species, taxa, plot_type
## dbl (7): record_id, month, day, year, plot_id, hindfoot_length, weight
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>surveys_wide &lt;- surveys %&gt;% 
  filter(!is.na(hindfoot_length)) %&gt;% 
  group_by(genus, plot_type) %&gt;% 
  summarise(mean_hindfoot = mean(hindfoot_length)) %&gt;% 
  pivot_wider(names_from = plot_type, values_from = mean_hindfoot) %&gt;% 
  arrange(Control)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;genus&#39;.
## You can override using the `.groups` argument.</code></pre>
<pre class="r"><code># 2
summary(surveys$weight)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##    4.00   20.00   37.00   42.67   48.00  280.00    2503</code></pre>
<pre class="r"><code># The final &quot;else&quot; argument here, where I used the T ~ &quot;large&quot; applies even to NAs, which is not something we want
surveys %&gt;% 
  mutate(weight_cat = case_when(
    weight &lt;= 20.00 ~ &quot;small&quot;,
    weight &gt; 20.00 &amp; weight &lt; 48.00 ~ &quot;medium&quot;,
    T ~ &quot;large&quot;
  ))</code></pre>
<pre><code>## # A tibble: 34,786 × 14
##    record_id month   day  year plot_id species_id sex   hindfoot_length weight
##        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt;
##  1         1     7    16  1977       2 NL         M                  32     NA
##  2        72     8    19  1977       2 NL         M                  31     NA
##  3       224     9    13  1977       2 NL         &lt;NA&gt;               NA     NA
##  4       266    10    16  1977       2 NL         &lt;NA&gt;               NA     NA
##  5       349    11    12  1977       2 NL         &lt;NA&gt;               NA     NA
##  6       363    11    12  1977       2 NL         &lt;NA&gt;               NA     NA
##  7       435    12    10  1977       2 NL         &lt;NA&gt;               NA     NA
##  8       506     1     8  1978       2 NL         &lt;NA&gt;               NA     NA
##  9       588     2    18  1978       2 NL         M                  NA    218
## 10       661     3    11  1978       2 NL         &lt;NA&gt;               NA     NA
## # ℹ 34,776 more rows
## # ℹ 5 more variables: genus &lt;chr&gt;, species &lt;chr&gt;, taxa &lt;chr&gt;, plot_type &lt;chr&gt;,
## #   weight_cat &lt;chr&gt;</code></pre>
<pre class="r"><code># To overcome this, case_when() allows us to not even use an &quot;else&quot; argument, and just specify the final argument to reduce confusion. This leaves NAs as is
surveys %&gt;% 
  mutate(weight_cat = case_when(
    weight &lt;= 20.00 ~ &quot;small&quot;,
    weight &gt; 20.00 &amp; weight &lt; 48.00 ~ &quot;medium&quot;,
    weight &gt;= 48.00 ~ &quot;large&quot;
  ))</code></pre>
<pre><code>## # A tibble: 34,786 × 14
##    record_id month   day  year plot_id species_id sex   hindfoot_length weight
##        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt;
##  1         1     7    16  1977       2 NL         M                  32     NA
##  2        72     8    19  1977       2 NL         M                  31     NA
##  3       224     9    13  1977       2 NL         &lt;NA&gt;               NA     NA
##  4       266    10    16  1977       2 NL         &lt;NA&gt;               NA     NA
##  5       349    11    12  1977       2 NL         &lt;NA&gt;               NA     NA
##  6       363    11    12  1977       2 NL         &lt;NA&gt;               NA     NA
##  7       435    12    10  1977       2 NL         &lt;NA&gt;               NA     NA
##  8       506     1     8  1978       2 NL         &lt;NA&gt;               NA     NA
##  9       588     2    18  1978       2 NL         M                  NA    218
## 10       661     3    11  1978       2 NL         &lt;NA&gt;               NA     NA
## # ℹ 34,776 more rows
## # ℹ 5 more variables: genus &lt;chr&gt;, species &lt;chr&gt;, taxa &lt;chr&gt;, plot_type &lt;chr&gt;,
## #   weight_cat &lt;chr&gt;</code></pre>
<pre class="r"><code># The &quot;else&quot; argument in ifelse() does not include NAs when specified, which is useful. The shortcoming, however, is that ifelse() does not allow you to leave out a final else argument, which means it is really important to always check the work on what that last argument assigns to.
surveys %&gt;% 
  mutate(weight_cat = ifelse(weight &lt;= 20.00, &quot;small&quot;,
                             ifelse(weight &gt; 20.00 &amp; weight &lt; 48.00, &quot;medium&quot;,&quot;large&quot;)))</code></pre>
<pre><code>## # A tibble: 34,786 × 14
##    record_id month   day  year plot_id species_id sex   hindfoot_length weight
##        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt;
##  1         1     7    16  1977       2 NL         M                  32     NA
##  2        72     8    19  1977       2 NL         M                  31     NA
##  3       224     9    13  1977       2 NL         &lt;NA&gt;               NA     NA
##  4       266    10    16  1977       2 NL         &lt;NA&gt;               NA     NA
##  5       349    11    12  1977       2 NL         &lt;NA&gt;               NA     NA
##  6       363    11    12  1977       2 NL         &lt;NA&gt;               NA     NA
##  7       435    12    10  1977       2 NL         &lt;NA&gt;               NA     NA
##  8       506     1     8  1978       2 NL         &lt;NA&gt;               NA     NA
##  9       588     2    18  1978       2 NL         M                  NA    218
## 10       661     3    11  1978       2 NL         &lt;NA&gt;               NA     NA
## # ℹ 34,776 more rows
## # ℹ 5 more variables: genus &lt;chr&gt;, species &lt;chr&gt;, taxa &lt;chr&gt;, plot_type &lt;chr&gt;,
## #   weight_cat &lt;chr&gt;</code></pre>
<pre class="r"><code># BONUS:
summ &lt;- summary(surveys$weight)
# Remember our indexing skills from the first weeks? Play around with single and double bracketing to see how it can extract values
summ[[2]]</code></pre>
<pre><code>## [1] 20</code></pre>
<pre class="r"><code>summ[[5]]</code></pre>
<pre><code>## [1] 48</code></pre>
<pre class="r"><code># Then you can next these into your code
surveys %&gt;% 
  mutate(weight_cat = case_when(
    weight &gt;= summ[[2]] ~ &quot;small&quot;,
    weight &gt; summ[[2]] &amp; weight &lt; summ[[5]] ~ &quot;medium&quot;,
    weight &gt;= summ[[5]] ~ &quot;large&quot;
  ))</code></pre>
<pre><code>## # A tibble: 34,786 × 14
##    record_id month   day  year plot_id species_id sex   hindfoot_length weight
##        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt;
##  1         1     7    16  1977       2 NL         M                  32     NA
##  2        72     8    19  1977       2 NL         M                  31     NA
##  3       224     9    13  1977       2 NL         &lt;NA&gt;               NA     NA
##  4       266    10    16  1977       2 NL         &lt;NA&gt;               NA     NA
##  5       349    11    12  1977       2 NL         &lt;NA&gt;               NA     NA
##  6       363    11    12  1977       2 NL         &lt;NA&gt;               NA     NA
##  7       435    12    10  1977       2 NL         &lt;NA&gt;               NA     NA
##  8       506     1     8  1978       2 NL         &lt;NA&gt;               NA     NA
##  9       588     2    18  1978       2 NL         M                  NA    218
## 10       661     3    11  1978       2 NL         &lt;NA&gt;               NA     NA
## # ℹ 34,776 more rows
## # ℹ 5 more variables: genus &lt;chr&gt;, species &lt;chr&gt;, taxa &lt;chr&gt;, plot_type &lt;chr&gt;,
## #   weight_cat &lt;chr&gt;</code></pre>
</details>
</div>
<div id="midterm" class="section level3">
<h3><small>Midterm </small></h3>
<p>This is the midterm exam for R-DAVIS Fall 2024. THE MIDTERM IS NOT
GRADED. This is strictly meant to be an assessment of your learning thus
far. You are welcome to use whatever materials you’d like. The exam is
meant to take 1 hour. When you are finished, save a .R script as
midterm_[lastname]_[firstname] in your class git repository and push
your script to github.</p>
<p>BACKGROUND: The pandemic spurred Tyler to get back into running
semi-seriously. That went pretty well until he hurt his Achilles tendon.
The sports med doctors at UC Davis filmed and analyzed his running. The
doctors said Tyler was getting old… and that he was over-striding and
putting too much pressure on his Achilles when landing. So in 2024,
Tyler has been practicing running differently. The doctors and trainers
are having Tyler increase his cadence (strides per minute) while
running, with the idea being that fast, short strides place less stress
on the lower body. For this exam, you are going to read in data that
Tyler has exported from his Garmin running watch and perform a
descriptive analysis to assess how successful this effort has been.</p>
<p>TASK DESCRIPTION:</p>
<ol style="list-style-type: decimal">
<li><p>Read in the file tyler_activity_laps_10-24.csv from the class
github page. This file is at url
<code>https://raw.githubusercontent.com/ucd-cepb/R-DAVIS/refs/heads/main/data/tyler_activity_laps_10-24.csv</code>,
so you can code that url value as a string object in R and call
read_csv() on that object. The file is a .csv file where each row is a
“lap” from an activity Tyler tracked with his watch.</p></li>
<li><p>Filter out any non-running activities.</p></li>
<li><p>Next, Tyler often has to take walk breaks between laps right now
because trying to change how you’ve run for 25 years is hard. You can
assume that any lap with a pace above 10 minute-per-mile pace is
walking, so remove those laps. You should also remove any abnormally
fast laps (&lt; 5 minute-per-mile pace) and abnormally short records
where the total elapsed time is one minute or less.</p></li>
<li><p>Create a new categorical variable, pace, that categorizes laps by
pace: “fast” (&lt; 6 minutes-per-mile), “medium” (6:00 to 8:00), and
“slow” ( &gt; 8:00). Create a second categorical variable,
<code>form</code> that distinguishes between laps run in the year 2024
(“new”, as Tyler started his rehab in January 2024) and all prior years
(“old”).</p></li>
<li><p>Identify the average steps per minute for laps by form and pace,
and generate a table showing these values with old and new as separate
rows and pace categories as columns. Make sure that <code>slow</code>
speed is the second column, <code>medium</code> speed is the third
column, and <code>fast</code> speed is the fourth column (hint: think
about what the <code>select()</code> function does).</p></li>
<li><p>Finally, Tyler thinks he’s been doing better since July after the
doctors filmed him running again and provided new advice. Summarize the
minimum, mean, median, and maximum steps per minute results for all laps
(regardless of pace category) run between January - June 2024 and July -
October 2024 for comparison.</p></li>
</ol>
<details>
<summary>
<strong>DO NOT OPEN</strong> until you are ready to see the answers!
</summary>
<pre class="r"><code>library(tidyverse)
url &lt;- &#39;https://raw.githubusercontent.com/ucd-cepb/R-DAVIS/refs/heads/main/data/tyler_activity_laps_10-24.csv&#39;
lap_dt &lt;- read_csv(url)</code></pre>
<pre><code>## Rows: 8985 Columns: 12
## ── Column specification ───────────────────────
## Delimiter: &quot;,&quot;
## chr   (1): sport
## dbl  (10): year, month, day, total_distance_m, minutes_per_mile, total_elaps...
## dttm  (1): timestamp
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>running_laps &lt;- lap_dt %&gt;% 
  filter(sport == &#39;running&#39;) %&gt;%
  filter(total_elapsed_time_s &gt;= 60) %&gt;%
  filter(minutes_per_mile &lt; 10 &amp; minutes_per_mile &gt; 5) %&gt;%
  mutate(pace_cat = case_when(minutes_per_mile &lt; 6 ~ &#39;fast&#39;,
                           minutes_per_mile &gt;=6 &amp; minutes_per_mile &lt; 8 ~ &#39;medium&#39;,
                           T ~ &#39;slow&#39;),
         form = case_when(year == 2024 ~ &#39;new form&#39;,
                          T ~ &#39;old form&#39;))

running_laps %&gt;% group_by(form,pace_cat) %&gt;% 
  summarize(avg_spm = mean(steps_per_minute)) %&gt;%
  pivot_wider(id_cols = form,values_from = avg_spm,names_from = pace_cat) %&gt;%
  select(form,slow,medium,fast)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;form&#39;.
## You can override using the `.groups` argument.</code></pre>
<pre><code>## # A tibble: 2 × 4
## # Groups:   form [2]
##   form      slow medium  fast
##   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1 new form  163.   166.  172.
## 2 old form  147.   149.  162.</code></pre>
<pre class="r"><code>running_laps %&gt;% filter(form == &#39;new form&#39;) %&gt;%
  mutate(months = ifelse(month %in% 1:6,&#39;early 2024&#39;,&#39;late 2024&#39;)) %&gt;%
  group_by(months) %&gt;% 
  summarize(
    min_spm = min(steps_per_minute),
    median_spm = median(steps_per_minute),
    mean_spm = mean(steps_per_minute),
    max_spm = max(steps_per_minute))</code></pre>
<pre><code>## # A tibble: 2 × 5
##   months     min_spm median_spm mean_spm max_spm
##   &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1 early 2024     148        162     162.     174
## 2 late 2024      156        170     171.     182</code></pre>
<details>
</div>
<div id="assignment-6" class="section level3">
<h3><small>Assignment 6</small></h3>
<p>For our week six homework, we are going to be practicing the skills
we learned with ggplot during class. You will be happy to know that we
are going to be using a brand new data set called
<code>gapminder</code>. This data set is looking at statistics for a few
different counties including population, GDP per capita, and life
expectancy. Download the data using the code below. Remember, this code
is looking for a folder called <code>data</code> to put the .csv in, so
make sure you have a folder named <code>data</code>, or modify the code
to the correct folder name.</p>
<pre class="r"><code>library(tidyverse)

gapminder &lt;- read_csv(&quot;https://ucd-r-davis.github.io/R-DAVIS/data/gapminder.csv&quot;) #ONLY change the &quot;data&quot; part of this path if necessary</code></pre>
<pre><code>## Rows: 1704 Columns: 6
## ── Column specification ───────────────────────
## Delimiter: &quot;,&quot;
## chr (2): country, continent
## dbl (4): year, pop, lifeExp, gdpPercap
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<ol style="list-style-type: decimal">
<li><p>First calculates mean life expectancy on each continent. Then
create a plot that shows how life expectancy has changed over time in
each continent. Try to do this all in one step using pipes! (aka, try
not to create intermediate dataframes)</p></li>
<li><p>Look at the following code and answer the following questions.
What do you think the <code>scale_x_log10()</code> line of code is
achieving? What about the <code>geom_smooth()</code> line of
code?</p></li>
</ol>
<p><em>Challenge!</em> Modify the above code to size the points in
proportion to the population of the country. <strong>Hint:</strong> Are
you translating data to a visual feature of the plot?</p>
<p><strong>Hint:</strong> There’s no cost to tinkering! Try some code
out and see what happens with or without particular elements.</p>
<pre class="r"><code>ggplot(gapminder, aes(x = gdpPercap, y = lifeExp)) +
    geom_point(aes(color = continent), size = .25) + 
    scale_x_log10() +
    geom_smooth(method = &#39;lm&#39;, color = &#39;black&#39;, linetype = &#39;dashed&#39;) +
    theme_bw()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="assignments_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Create a boxplot that shows the life expectency for Brazil, China,
El Salvador, Niger, and the United States, with the data points in the
backgroud using geom_jitter. Label the X and Y axis with “Country” and
“Life Expectancy” and title the plot “Life Expectancy of Five
Countries”.</li>
</ol>
<details>
<summary>
<strong>DO NOT OPEN</strong> until you are ready to see the answers!
</summary>
<pre class="r"><code>library(tidyverse)

#PROBLEM 1:

gapminder %&gt;%
  group_by(continent, year) %&gt;% 
  summarize(mean_lifeExp = mean(lifeExp)) %&gt;% #calculating the mean life expectancy for each continent and year
  ggplot()+
  geom_point(aes(x = year, y = mean_lifeExp, color = continent))+ #scatter plot
  geom_line(aes(x = year, y = mean_lifeExp, color = continent)) #line plot</code></pre>
<pre><code>## `summarise()` has grouped output by
## &#39;continent&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="assignments_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>#there are other ways to represent this data and answer this question. Try a facet wrap! Play around with themes and ggplotly!  



#PROBLEM 2:

#challenge answer
ggplot(gapminder, aes(x = gdpPercap, y = lifeExp)) +
    geom_point(aes(color = continent, size = pop)) + 
    scale_x_log10() +
    geom_smooth(method = &#39;lm&#39;, color = &#39;black&#39;, linetype = &#39;dashed&#39;) +
    theme_bw()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="assignments_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<pre class="r"><code>#PROBLEM 3: 

countries &lt;- c(&quot;Brazil&quot;, &quot;China&quot;, &quot;El Salvador&quot;, &quot;Niger&quot;, &quot;United States&quot;) #create a vector with just the countries we are interested in

gapminder %&gt;% 
  filter(country %in% countries) %&gt;% 
  ggplot(aes(x = country, y = lifeExp))+
  geom_boxplot() +
  geom_jitter(alpha = 0.3, color = &quot;blue&quot;)+
  theme_minimal() +
  ggtitle(&quot;Life Expectancy of Five Countries&quot;) + #title the figure
  theme(plot.title = element_text(hjust = 0.5)) + #centered the plot title
  xlab(&quot;Country&quot;) + ylab(&quot;Life Expectancy&quot;) #how to change axis names</code></pre>
<img src="assignments_files/figure-html/unnamed-chunk-11-3.png" width="672" />
</details>
</div>
<div id="assignment-7" class="section level3">
<h3><small>Assignment 7</small></h3>
<p>For week 7, we’re going to be working on 2 critical
<code>ggplot</code> skills: recreating a graph from a dataset and
<strong>googling stuff</strong>.</p>
<p>Our goal will be to make this final graph using the
<code>gapminder</code> dataset:</p>
<p><img src="assignments_files/figure-html/unnamed-chunk-13-1.png" width="768" /></p>
<p>The x axis labels are all scrunched up because we can’t make the
image bigger on the webpage, but if you make it and then zoom it bigger
in RStudio it looks much better.</p>
<p>We’ll touch on some intermediate steps here, since it might take
quite a few steps to get from start to finish. Here are some things to
note:</p>
<ol style="list-style-type: decimal">
<li><p>To get the population difference between 2002 and 2007 for each
country, it would probably be easiest to have a country in each row and
a column for 2002 population and a column for 2007 population.</p></li>
<li><p>Notice the order of countries within each facet. You’ll have to
look up how to order them in this way.</p></li>
<li><p>Also look at how the axes are different for each facet. Try
looking through <code>?facet_wrap</code> to see if you can figure this
one out.</p></li>
<li><p>The color scale is different from the default- feel free to try
out other color scales, just don’t use the defaults!</p></li>
<li><p>The theme here is different from the default in a few ways,
again, feel free to play around with other non-default themes.</p></li>
<li><p>The axis labels are rotated! Here’s a hint:
<code>angle = 45, hjust = 1</code>. It’s up to you (and Google) to
figure out where this code goes!</p></li>
<li><p>Is there a legend on this plot?</p></li>
</ol>
<p>This lesson should illustrate a key reality of making plots in R, one
that applies as much to experts as beginners: 10% of your effort gets
the plot 90% right, and 90% of the effort is getting the plot perfect.
<code>ggplot</code> is incredibly powerful for exploratory analysis, as
you can get a good plot with only a few lines of code. It’s also
extremely flexible, allowing you to tweak nearly everything about a plot
to get a highly polished final product, but these little tweaks can take
a lot of time to figure out!</p>
<p>So if you spend most of your time on this lesson googling stuff,
you’re not alone!</p>
<details>
<summary>
<strong>DO NOT OPEN</strong> until you are ready to see the answers
</summary>
<pre class="r"><code>library(tidyverse)

gapminder &lt;- read_csv(&quot;data/gapminder.csv&quot;)

pg &lt;- gapminder %&gt;% 
  select(country, year, pop, continent) %&gt;% 
  filter(year &gt; 2000) %&gt;% 
  pivot_wider(names_from = year, values_from = pop) %&gt;% 
  mutate(pop_change_0207 = `2007` - `2002`)

pg %&gt;% 
  filter(continent != &quot;Oceania&quot;) %&gt;% 
  ggplot(aes(x = reorder(country, pop_change_0207), y = pop_change_0207)) +
  geom_col(aes(fill = continent)) +
  facet_wrap(~continent, scales = &quot;free&quot;) +
  theme_bw() +
  scale_fill_viridis_d() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        legend.position = &quot;none&quot;) +
  xlab(&quot;Country&quot;) +
  ylab(&quot;Change in Population Between 2002 and 2007&quot;)</code></pre>
</details>
</div>
<div id="assignment-8" class="section level3">
<h3><small>Assignment 8</small></h3>
<p>Let’s look at some real data from Mauna Loa to try to format and
plot. These meteorological data from Mauna Loa were collected every
minute for the year 2001. <em>This dataset has 459,769 observations for
9 different metrics of wind, humidity, barometric pressure, air
temperature, and precipitation.</em> Download this dataset <a
href="data/mauna_loa_met_2001_minute.rda">here</a>. Save it to your
<code>data/</code> folder. Alternatively, you can read the CSV directly
from the R-DAVIS Github:
<code>mloa &lt;- read_csv("https://raw.githubusercontent.com/gge-ucd/R-DAVIS/master/data/mauna_loa_met_2001_minute.csv")</code></p>
<p>Use the <a href="data/mauna_loa_README.txt">README</a> file
associated with the Mauna Loa dataset to determine in what time zone the
data are reported, and how missing values are reported in each column.
With the <code>mloa</code> data.frame, remove observations with missing
values in rel_humid, temp_C_2m, and windSpeed_m_s. Generate a column
called “datetime” using the year, month, day, hour24, and min columns.
Next, create a column called “datetimeLocal” that converts the datetime
column to Pacific/Honolulu time (<em>HINT</em>: look at the lubridate
function called <code>with_tz()</code>). Then, use dplyr to calculate
the mean hourly temperature each month using the temp_C_2m column and
the datetimeLocal columns. (<em>HINT</em>: Look at the lubridate
functions called <code>month()</code> and <code>hour()</code>). Finally,
make a ggplot scatterplot of the mean monthly temperature, with points
colored by local hour.</p>
Answers:
<details>
<summary>
<strong>DO NOT OPEN</strong> until you are ready to see the answers
</summary>
<pre class="r"><code>library(tidyverse)
library(lubridate)
## Data import
mloa &lt;- read_csv(&quot;https://raw.githubusercontent.com/ucd-r-davis/R-DAVIS/master/data/mauna_loa_met_2001_minute.csv&quot;)

mloa2 = mloa %&gt;%
  # Remove NA&#39;s
  filter(rel_humid != -99) %&gt;%
  filter(temp_C_2m != -999.9) %&gt;%
  filter(windSpeed_m_s != -999.9) %&gt;%
  # Create datetime column (README indicates time is in UTC)
  mutate(datetime = ymd_hm(paste0(year,&quot;-&quot;, 
                                  month, &quot;-&quot;, 
                                  day,&quot; &quot;, 
                                  hour24, &quot;:&quot;, 
                                  min), 
                           tz = &quot;UTC&quot;)) %&gt;%
  # Convert to local time
  mutate(datetimeLocal = with_tz(datetime, tz = &quot;Pacific/Honolulu&quot;))

## Aggregate and plot
mloa2 %&gt;%
  # Extract month and hour from local time column
  mutate(localMon = month(datetimeLocal, label = TRUE),
         localHour = hour(datetimeLocal)) %&gt;%
  # Group by local month and hour
  group_by(localMon, localHour) %&gt;%
  # Calculate mean temperature
  summarize(meantemp = mean(temp_C_2m)) %&gt;%
  # Plot
  ggplot(aes(x = localMon,
             y = meantemp)) +
  # Color points by local hour
  geom_point(aes(col = localHour)) +
  # Use a nice color ramp
  scale_color_viridis_c() +
  # Label axes, add a theme
  xlab(&quot;Month&quot;) +
  ylab(&quot;Mean temperature (degrees C)&quot;) +
  theme_classic()</code></pre>
</details>
</div>
<div id="assignment-9" class="section level3">
<h3><small>Assignment 9</small></h3>
<p>In this assignment, you’ll use the iteration skills we built in the
course to apply functions to an entire dataset.</p>
<p>Let’s load the surveys dataset:</p>
<pre class="r"><code>surveys &lt;- read.csv(&quot;data/portal_data_joined.csv&quot;)</code></pre>
<ol style="list-style-type: decimal">
<li>Using a for loop, print to the console the longest species name of
each taxon. Hint: the function nchar() gets you the number of characters
in a string.</li>
</ol>
<p>Next let’s load the Mauna Loa dataset from last week.</p>
<pre class="r"><code>mloa &lt;- read_csv(&quot;https://raw.githubusercontent.com/ucd-cepb/R-DAVIS/master/data/mauna_loa_met_2001_minute.csv&quot;)</code></pre>
<pre><code>## Rows: 459769 Columns: 16
## ── Column specification ───────────────────────
## Delimiter: &quot;,&quot;
## chr  (2): filename, siteID
## dbl (14): year, month, day, hour24, min, windDir, windSpeed_m_s, windSteady,...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><p>Use the map function from purrr to print the max of each of the
following columns:
“windDir”,“windSpeed_m_s”,“baro_hPa”,“temp_C_2m”,“temp_C_10m”,“temp_C_towertop”,“rel_humid”,and
“precip_intens_mm_hr”.</p></li>
<li><p>Make a function called C_to_F that converts Celsius to
Fahrenheit. Hint: first you need to multiply the Celsius temperature by
1.8, then add 32. Make three new columns called “temp_F_2m”,
“temp_F_10m”, and “temp_F_towertop” by applying this function to columns
“temp_C_2m”, “temp_C_10m”, and “temp_C_towertop”. Bonus: can you do this
by using map_df? Don’t forget to name your new columns “temp_F…” and not
“temp_C…”!</p></li>
</ol>
Challenge: Use lapply to create a new column of the surveys dataframe
that includes the genus and species name together as one string.
<details>
<summary>
<strong>DO NOT OPEN</strong> until you are ready to see the answers
</summary>
<pre class="r"><code>#part 1
for(i in unique(surveys$taxa)){
  mytaxon &lt;- surveys[surveys$taxa == i,]
  longestnames &lt;- mytaxon[nchar(mytaxon$species) == max(nchar(mytaxon$species)),] %&gt;% select(species)
  print(paste0(&quot;The longest species name(s) among &quot;, i, &quot;s is/are: &quot;))
  print(unique(longestnames$species))
}

#part 2
mycols &lt;- mloa %&gt;% select(&quot;windDir&quot;,&quot;windSpeed_m_s&quot;,&quot;baro_hPa&quot;,&quot;temp_C_2m&quot;,&quot;temp_C_10m&quot;,&quot;temp_C_towertop&quot;,&quot;rel_humid&quot;, &quot;precip_intens_mm_hr&quot;)
mycols %&gt;% map(max, na.rm = T)

#part 3
C_to_F &lt;- function(x){
  x * 1.8 + 32
}

mloa$temp_F_2m &lt;- C_to_F(mloa$temp_C_2m)
mloa$temp_F_10m &lt;- C_to_F(mloa$temp_C_10m)
mloa$temp_F_towertop &lt;- C_to_F(mloa$temp_C_towertop)

#Bonus:
mloa %&gt;% select(c(&quot;temp_C_2m&quot;, &quot;temp_C_10m&quot;, &quot;temp_C_towertop&quot;)) %&gt;% map_df(C_to_F) %&gt;% rename(&quot;temp_F_2m&quot;=&quot;temp_C_2m&quot;, &quot;temp_F_10m&quot;=&quot;temp_C_10m&quot;, &quot;temp_F_towertop&quot;=&quot;temp_C_towertop&quot;) %&gt;% cbind(mloa)

#challenge
surveys$genusspecies &lt;- lapply(1:length(surveys$species), function(i){
  paste0(surveys$genus[i], &quot; &quot;, surveys$species[i])
})</code></pre>
</details>
</div>
<div id="reflection" class="section level3">
<h3><small>Reflection</small></h3>
<ul>
<li>Complete the <a
href="https://docs.google.com/forms/d/e/1FAIpQLScR_AUTFx4Q9tL2QJumIEeOGdwFvyEsrqrZMXkwAqi2AzBFRw/viewform?usp=sharing">post-course
credit reflection</a></li>
</ul>
</div>
<div id="final" class="section level3">
<h3><small>Final </small></h3>
<p>This is the final exam for R-DAVIS Fall 2024. THE FINAL IS NOT
GRADED. This is strictly meant to be an assessment of your learning thus
far. You are welcome to use whatever materials you’d like. The exam is
meant to take 1 hour. When you are finished, save a .R script as
final_[lastname]_[firstname] in your class git repository and push your
script to github.</p>
<p>BACKGROUND</p>
<p>For the midterm, you compared Tyler’s old running data with recent
data to analyze to see if there was any difference in strides-per-minute
(SPM). On July 1, 2024, Tyler went to a follow-up appointment with the
UCD Sports Medicine clinic, and they told him that has cadence was still
too low, and that his form was perhaps <em>more</em> damaging than it
had been. The technician gave Tyler some training cues, as well as the
advice that “elite professional runners are at least 180
strides-per-minute, so aim for that”.</p>
<p>Tyler looked into it, and found out that:</p>
<ul>
<li><p>He is not an elite professional runner</p></li>
<li><p>That 180 number was based on strides counted in the 1984 MEN’S
OLYMPIC 10K FINAL (seriously, this is true)</p></li>
</ul>
<p>Given these two facts, the conclusion (since confirmed with
technician) is that what really matters is not just high cadence but a
positive relationship between cadence and speed. Perform the tasks below
to analyze whether Tyler’s SPM appears responsive to changes in pace,
and more importantly whether things have improved since the July 1
check-up.</p>
<p>TASK DESCRIPTION</p>
<ol style="list-style-type: decimal">
<li><p>Read in the file tyler_activity_laps_12-6.csv from the class
github page. This file is at url
<code>https://raw.githubusercontent.com/UCD-R-DAVIS/R-DAVIS/refs/heads/main/data/tyler_activity_laps_12-6.csv</code>,
so you can code that url value as a string object in R and call
read_csv() on that object. The file is a .csv file where each row is a
“lap” from an activity Tyler tracked with his watch.</p></li>
<li><p>Filter out any non-running activities.</p></li>
<li><p>We are interested in <em>normal</em> running. You can assume that
any lap with a pace above 10 <code>minutes_per_mile</code> pace is
walking, so remove those laps. You should also remove any abnormally
fast laps (&lt; 5 <code>minute_per_mile</code> pace) and abnormally
short records where the total elapsed time is one minute or
less.</p></li>
<li><p>Group observations into three time periods corresponding to
pre-2024 running, Tyler’s initial rehab efforts from January to June of
this year, and activities from July to the present.</p></li>
<li><p>Make a scatter plot that graphs SPM over speed by lap.</p></li>
<li><p>Make 5 aesthetic changes to the plot to improve the
visual.</p></li>
<li><p>Add linear (i.e., straight) trendlines to the plot to show the
relationship between speed and SPM for each of the three time periods
(hint: you might want to check out the options for
<code>geom_smooth()</code>)</p></li>
<li><p>Does this relationship maintain or break down as Tyler gets
tired? Focus just on post-intervention runs (after July 1, 2024). Make a
plot (of your choosing) that shows SPM vs. speed by <em>lap</em>. Use
the <code>timestamp</code> indicator to assign lap numbers, assuming
that all laps on a given day correspond to the same run (hint: check out
the <code>rank()</code> function). Select only laps 1-3 (Tyler never
runs more than three miles these days). Make a plot that shows SPM,
speed, <em>and</em> lap number (pick a visualization that you think best
shows these three variables).</p></li>
</ol>
<details>
<summary>
We’ll post the answer key Thursday afternoon.
</summary>
</details>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
